From 28df5f273483ad404a1cd1c944cf44b924c834e0 Mon Sep 17 00:00:00 2001
From: Laura Woelbeling <s0548106@htw-berlin.de>
Date: Sat, 19 Jan 2019 21:50:29 +0100
Subject: [PATCH] fixed login errors

bug 1: signup not possible, because params not allowed
bug 2: redirect after signup to user list (but is forbidden for normal
users) -> redirect to login page instead
---
 app/controllers/users_controller.rb | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/app/controllers/users_controller.rb b/app/controllers/users_controller.rb
index 7826a15..e6b6ec4 100644
--- a/app/controllers/users_controller.rb
+++ b/app/controllers/users_controller.rb
@@ -43,8 +43,8 @@ class UsersController < ApplicationController
 
     respond_to do |format|
       if @user.save
-        format.html { redirect_to @user, notice: 'User was successfully created.' }
-        format.json { render :show, status: :created, location: @user }
+        format.html { redirect_to login_path, notice: 'User was successfully created.' }
+        format.json { render login_path, status: :created, location: @user }
       else
         format.html { render :new }
         format.json { render json: @user.errors, status: :unprocessable_entity }
@@ -84,6 +84,7 @@ class UsersController < ApplicationController
 
     # Never trust parameters from the scary internet, only allow the white list through.
     def user_params
-      params.fetch(:user, {})
+      #params.fetch(:user, {})
+	  params.require(:user).permit(:first_name, :last_name, :email, :password, :password_confirmation)
     end
 end
-- 
2.10.2.windows.1

