<script type="text/javascript">

// create a new marker and add to map
var marker_<%= site.id %> = L.marker([<%= site.latitude %>, <%= site.longitude %>], {icon: myDivIcon, title: '<%= site.name %>', riseOnHover: true});
marker_<%= site.id %>.addTo(map).bindPopup('<b><%= site.name %></b><br /><%= site.description %>');

$(marker_<%= site.id %>._icon).attr('id', 'divmarker_<%= site.id %>');

// bind cross-target hover events
marker_<%= site.id %>.on("mouseover", function() {
	this.openPopup();
	$("#site_<%= site.id %>").addClass( "hover" );
});
marker_<%= site.id %>.on("mouseout", function() {
	this.closePopup();
	$("#site_<%= site.id %>").removeClass( "hover" );
});
$("#site_<%= site.id %>").hover(function() {
	marker_<%= site.id %>.openPopup();
}, function() {
	marker_<%= site.id %>.closePopup();
});

// bind click event
$("#divmarker_<%= site.id %>").html('<%= link_to "Show", site, remote: true %>');
	 
</script>
